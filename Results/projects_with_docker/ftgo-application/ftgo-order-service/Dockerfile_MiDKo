# Base image
FROM eventuateio/eventuate-examples-docker-images-spring-example-base-image:$baseImageVersion

# Set up the work directory
WORKDIR /app

# Copy the compiled jar file generated by Gradle
COPY build/libs/ftgo-order-service.jar service.jar

# Expose the necessary port
EXPOSE 8080

# Set necessary environment variables; these are placeholders
ENV JAVA_INSTANCE_NAME Instance1
ENV SPRING_PROFILE default
ENV SPRING_DATASOURCE_URL jdbc:mysql://localhost:3306/myDb
ENV SPRING_DATASOURCE_USERNAME root
ENV SPRING_DATASOURCE_PASSWORD pass

# Set health checks; these are placeholders
HEALTHCHECK --interval=5m --timeout=3s \
  CMD curl -f http://localhost:8080/health || exit 1

# Final command to run
ENTRYPOINT ["java", "-jar", "service.jar"]
