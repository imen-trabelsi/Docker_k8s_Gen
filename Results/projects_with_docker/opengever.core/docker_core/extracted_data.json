{
    "source_code_info": {
        "language": "Python",
        "framework": "Python",
        "dependencies": {
            "pyproject.toml": "[tool.towncrier]\npackage = \"opengever.core\"\nfilename = \"HISTORY.rst\"\ndirectory = \"changes/\"\ntemplate = \"towncrier.rst\"\nunderlines = [\"-\", \"\"]\nissue_format = \"{issue}\"\n\n[[tool.towncrier.type]]\ndirectory = \"feature\"\nname = \"New features:\"\nshowcontent = true\n\n[[tool.towncrier.type]]\ndirectory = \"bugfix\"\nname = \"Bug fixes:\"\nshowcontent = true\n\n[[tool.towncrier.type]]\ndirectory = \"other\"\nname = \"Other changes:\"\nshowcontent = true\n\n"
        },
        "database": null,
        "build_system": "poetry",
        "config_files": {
            "docker-compose.yml": "services:\n  httpd:\n    image: 4teamwork/oghttpd:latest\n    build:\n      context: .\n      dockerfile: ./docker/httpd/Dockerfile\n    ports:\n      - \"8088:80\"\n    depends_on:\n      - ogui\n      - ogcore\n    environment:\n      - HTTP_PROTOCOL=http\n      - HTTP_PORT=8088\n      - PORTAL_HOST=ianus-frontend\n    profiles:\n      - all\n  msgconvert:\n    image: 4teamwork/msgconvert:latest\n    ports:\n      - 8090:8080\n  sablon:\n    image: 4teamwork/sablon:latest\n    ports:\n      - 8091:8080\n  pdflatex:\n    image: 4teamwork/pdflatex:latest\n    ports:\n      - 8092:8080\n  weasyprint:\n    image: 4teamwork/weasyprint:latest\n    ports:\n      - 8093:8080\n  clamav:\n    image: clamav/clamav:latest\n    ports:\n      - '3310:3310'\n    volumes:\n      - clam_db:/var/lib/clamav\n      - ./clamav/clamd.conf:/etc/clamav/clamd.conf\n    profiles:\n      - clamav\n  ogui:\n    image: 4teamwork/ogui:latest\n    profiles:\n      - all\n  ogcore: &ogcore\n    build:\n      context: .\n      dockerfile: ./docker/core/Dockerfile\n      secrets:\n        - gldt\n    image: 4teamwork/ogcore:latest\n    volumes:\n      - ./var/ogcore:/data\n    ports:\n      - \"8080:8080\"\n      - \"8160:8160\"\n    environment:\n      - PLONE_LDAP_BIND_UID=${LDAP_BIND_DN:-cn=admin,dc=dev,dc=onegovgever,dc=ch}\n      - PLONE_LDAP_BIND_PWD=${LDAP_BIND_PASSWORD:-secret}\n      - MSGCONVERT_URL=http://msgconvert:8080/\n      - SABLON_URL=http://sablon:8080/\n      - PDFLATEX_URL=http://pdflatex:8080/\n      - WEASYPRINT_URL=http://weasyprint:8080/\n      - OGDS_SYNC_URL=http://ogds-sync:8080/\n    depends_on:\n      - zeoserver\n      - ogds\n      - solr\n    profiles:\n      - all\n      - ogcore\n  ogcore-cron:\n    <<: *ogcore\n    command: cron\n    ports:\n      - \"8082:8080\"\n    profiles:\n      - all\n      - ogcore-cron\n  zeoserver:\n    image: 4teamwork/zeoserver:4.3.20\n    volumes:\n      - ./var/ogcore:/data\n    profiles:\n      - all\n      - ogcore\n  ogds:\n    image: postgres:13-alpine\n    volumes:\n      - ogds:/var/lib/postgresql/data\n    environment:\n      - POSTGRES_USER=${OGDS_DB_USER:-ogds}\n      - POSTGRES_PASSWORD=${OGDS_DB_PASSWORD:-secret}\n      - POSTGRES_DB=${OGDS_DB_NAME:-ogds}\n    ports:\n      - 15432:5432\n  ogds-sync:\n    image: 4teamwork/ogds-sync:latest\n    ports:\n      - 8099:8080\n    environment:\n      - OGDS_DSN=postgresql://${OGDS_DB_USER:-ogds}:${OGDS_DB_PASSWORD:-secret}@${OGDS_DB_HOST:-ogds}/${OGDS_DB_NAME:-ogds}\n      - LDAP_PROFILE=${LDAP_PROFILE:-OpenLDAPLegacy}\n      - LDAP_URL=${LDAP_SERVER_URI:-ldap://ldap:1389}\n      - LDAP_BIND_DN=${LDAP_BIND_DN:-cn=admin,dc=dev,dc=onegovgever,dc=ch}\n      - LDAP_BIND_PASSWORD=${LDAP_BIND_PASSWORD:-secret}\n      - LDAP_USER_BASE_DN=${LDAP_USER_BASE_DN:-ou=Users,dc=dev,dc=onegovgever,dc=ch}\n      - LDAP_GROUP_BASE_DN=${LDAP_GROUP_BASE_DN:-ou=Groups,dc=dev,dc=onegovgever,dc=ch}\n    depends_on:\n      - ogds\n  solr:\n    image: 4teamwork/ogsolr:latest\n    build:\n      context: .\n      dockerfile: ./docker/solr/Dockerfile\n    command: solr-foreground\n    volumes:\n      - ./var/solr:/var/solr/data\n    environment:\n      - SOLR_CORES=development testing functionaltesting testserver\n    ports:\n      - 8983:8983\n  redis:\n    image: redis:6.2-alpine\n    command:\n      - redis-server\n      - --save 60 1\n    ports:\n      - 6379:6379\n    volumes:\n      - ./var/redis:/data\n  ldap:\n    image: bitnami/openldap:2.6\n    ports:\n      - 1389:1389\n    environment:\n      - LDAP_ADMIN_USERNAME=admin\n      - LDAP_ADMIN_PASSWORD=secret\n      - LDAP_ROOT=dc=dev,dc=onegovgever,dc=ch\n      - LDAP_ADMIN_DN=cn=admin,dc=dev,dc=onegovgever,dc=ch\n    volumes:\n      - ./docker/ldap.ldif:/ldifs/ldap.ldif\n      - ./var/openldap:/bitnami/openldap\n  mta:\n    image: 4teamwork/ogmta:latest\n    build:\n      context: .\n      dockerfile: ./docker/mta/Dockerfile\n    ports:\n      - '8025:25'\n    environment:\n      POSTFIX_MYHOSTNAME: ogmta.onegovgever.ch\n      POSTFIX_MYORIGIN: dev.onegovgever.ch\n      POSTFIX_SMTPD_TLS_SECURITY_LEVEL: none\n      VIRTUAL_DOMAINS_0: name=dev.onegovgever.ch,url=http://ogcore:8080/ogsite\n    profiles:\n      - mta\n  ianus-frontend:\n    image: ghcr.io/4teamwork/ianus-frontend:2024.2.0\n    ports:\n      - \"3000:80\"\n    depends_on:\n      - ianus-backend\n    environment:\n      - IANUS_BACKEND_HOST=ianus-backend\n      - IANUS_PATH_PREFIX=/portal\n    profiles:\n      - all\n      - ianus\n  ianus-backend:\n    image: ghcr.io/4teamwork/ianus-backend:2024.2.0\n    ports:\n      - \"8000:8000\"\n    depends_on:\n      - ianus-db\n    environment:\n      - DJANGO_SECRET_KEY=secret\n      - DJANGO_ALLOWED_HOSTS=localhost,teamraum,gever,ianus-frontend\n      - DJANGO_PATH_PREFIX=/portal\n      - DJANGO_SESSION_COOKIE_SECURE=False\n      - DJANGO_CSRF_COOKIE_SECURE=False\n      - DJANGO_DATABASE_NAME=ianus\n      - DJANGO_DATABASE_USER=ianus\n      - DJANGO_DATABASE_PASSWORD=secret\n      - DJANGO_DATABASE_HOST=ianus-db\n      - DJANGO_DATABASE_PORT=5432\n      - DJANGO_TWO_FACTOR_REQUIRED=False\n      - DJANGO_OIDC_RP_SIGN_ALGO=HS256\n      - DJANGO_AUTH_LDAP_BIND_DN=${LDAP_BIND_DN:-cn=admin,dc=dev,dc=onegovgever,dc=ch}\n      - DJANGO_AUTH_LDAP_BIND_PASSWORD=${LDAP_BIND_PASSWORD:-secret}\n      - DJANGO_AUTH_LDAP_SERVER_URI=${LDAP_SERVER_URI:-ldap://ldap:1389}\n      - DJANGO_AUTH_LDAP_USER_BASE_DN=${LDAP_USER_BASE_DN:-ou=Users,dc=dev,dc=onegovgever,dc=ch}\n      - DJANGO_AUTH_LDAP_USER_ATTR_MAP={'first_name':'givenName','last_name':'sn','email':'mail','username':'uid'}\n      - DJANGO_AUTH_LDAP_GROUP_BASE_DN=ou=Groups,dc=dev,dc=onegovgever,dc=ch\n      - DJANGO_AUTH_LDAP_GROUP_TYPE_CLASS=django_auth_ldap.config.GroupOfUniqueNamesType\n      - DJANGO_AUTH_LDAP_GROUP_MEMBER_ATTR=uniqueMember\n      - DJANGO_AUTH_LDAP_GROUP_SEARCH_FILTER=(objectClass=groupOfUniqueNames)\n      - DJANGO_AUTH_LDAP_USER_ADDITIONAL_ATTRS=memberOf\n      - DJANGO_CAS_USER_ATTR_MAP={'email':'mail','firstname':'givenName','lastname':'sn','groups':'memberOf'}\n\n    profiles:\n      - all\n      - ianus\n  ianus-db:\n    image: postgres:13-alpine\n    volumes:\n      - ./var/ianus-db:/var/lib/postgresql/data\n    environment:\n      - POSTGRES_DB=ianus\n      - POSTGRES_USER=ianus\n      - POSTGRES_PASSWORD=secret\n    profiles:\n      - all\n      - ianus\n  testserver-solr:\n    image: 4teamwork/ogsolr:latest\n    build:\n      context: .\n      dockerfile: ./docker/solr/Dockerfile\n    command: solr-foreground\n    environment:\n      - SOLR_CORES=testserver\n    ports:\n      - 18983:8983\n    profiles:\n      - testserver\n  testserver:\n    build:\n      context: .\n      dockerfile: ./docker/testserver/Dockerfile\n      secrets:\n        - gldt\n    image: 4teamwork/ogtestserver:latest\n    ports:\n      - 55001:55001\n      - 55002:55002\n    environment:\n      - SOLR_HOSTNAME=testserver-solr\n      - TESTSERVER_REUSE_RUNNING_SOLR=8983\n      - SOLR_PORT=8983\n      - MSGCONVERT_URL=http://msgconvert:8080/\n      - SABLON_URL=http://sablon:8080/\n      - PDFLATEX_URL=http://pdflatex:8080/\n      - WEASYPRINT_URL=http://weasyprint:8080/\n    depends_on:\n      - msgconvert\n      - sablon\n      - pdflatex\n      - weasyprint\n      - testserver-solr\n    profiles:\n      - testserver\n\n  kub:\n    image: 4teamwork/kub:latest\n    ports:\n      - \"3100:8000\"\n    depends_on:\n      - kub-db\n    environment:\n      DJANGO_ALLOWED_HOSTS: localhost,127.0.0.1\n      DJANGO_SECRET_KEY: secret\n      DJANGO_DATABASE_HOST: kub-db\n      DJANGO_DATABASE_NAME: kub\n      DJANGO_DATABASE_USER: kub\n      DJANGO_DATABASE_PASSWORD: secret\n      CAS_SERVER_URL: http://ianus-frontend/portal/cas\n      CAS_ROOT_PROXIED_AS: http://localhost:3100\n      ALLOWED_PORTAL_GROUPS: all\n    volumes:\n      - kub_media:/app/media\n    profiles:\n      - kub\n  kub-db:\n    image: postgres:13-alpine\n    volumes:\n      - kub_db:/var/lib/postgresql/data\n    environment:\n      POSTGRES_USER: kub\n      POSTGRES_PASSWORD: secret\n      POSTGRES_DB: kub\n    profiles:\n      - kub\n\nvolumes:\n  ogds:\n  clam_db:\n  kub_db:\n  kub_media:\n\nsecrets:\n  gldt:\n    environment: GITLAB_DEPLOY_TOKEN\n",
            "docker/core/Dockerfile": "# pkg builder\n# -----------------------------------------------------------------------------\nFROM alpine:3.20 AS pkg-builder\n\nRUN apk -U add \\\n    sudo \\\n    alpine-sdk \\\n    apkbuild-pypi\n\nRUN mkdir -p /var/cache/distfiles && \\\n    adduser -D packager && \\\n    addgroup packager abuild && \\\n    chgrp abuild /var/cache/distfiles && \\\n    chmod g+w /var/cache/distfiles && \\\n    echo \"packager ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\n\nWORKDIR /work\nUSER packager\n\nRUN abuild-keygen -a -i -n\n\nCOPY --chown=packager:packager ./docker/core/packages/ ./\n\nRUN cd openssl1.1-compat && \\\n    abuild -r\n\n# ogcore builder\n# -----------------------------------------------------------------------------\nFROM 4teamwork/plone:4.3.20-alpine3.20 AS builder\nUSER root\n\nRUN --mount=from=pkg-builder,source=/home/packager/packages/work,target=/packages \\\n    --mount=from=pkg-builder,source=/etc/apk/keys,target=/etc/apk/keys \\\n    apk --repository /packages add \\\n    gcc \\\n    musl-dev \\\n    libc-dev \\\n    zlib-dev \\\n    libjpeg-turbo-dev \\\n    libpng-dev \\\n    libxml2-dev \\\n    libxslt-dev \\\n    openldap-dev \\\n    openssl1.1-compat-dev \\\n    libffi-dev \\\n    libpq \\\n    libpq-dev \\\n    gettext\n\n# Fix support for python-ldap<3.4.2 with OpenLDAP 2.6\nRUN echo \"INPUT ( libldap.so )\" > /usr/lib/libldap_r.so\n\nWORKDIR /app\n\nENV PATH=\"/app/bin:$PATH\"\n\nCOPY ./docker/core/requirements-core.txt ./docker/core/requirements-deployment.txt /app/\nRUN --mount=type=cache,target=/root/.cache \\\n    --mount=type=secret,id=gldt \\\n    export GITLAB_DEPLOY_TOKEN=$(cat /run/secrets/gldt) && \\\n    CFLAGS=\"-I/usr/include/openssl1.1\" \\\n    LDFLAGS=\"-L/usr/lib/openssl1.1\" \\\n    pip install \\\n    --prefix /app \\\n    --extra-index-url https://__token__:$GITLAB_DEPLOY_TOKEN@git.4teamwork.ch/api/v4/projects/486/packages/pypi/simple \\\n    -r requirements-core.txt \\\n    -r requirements-deployment.txt\n\nCOPY setup.py README.rst HISTORY.rst ./\nCOPY ./opengever ./opengever\nCOPY ./plonetheme ./plonetheme\nCOPY ./src ./src\n\nRUN --mount=type=cache,target=/root/.cache \\\n    --mount=type=secret,id=gldt \\\n    export GITLAB_DEPLOY_TOKEN=$(cat /run/secrets/gldt) && \\\n    pip install \\\n    --prefix /app \\\n    --extra-index-url https://__token__:$GITLAB_DEPLOY_TOKEN@git.4teamwork.ch/api/v4/projects/486/packages/pypi/simple \\\n    -e . \\\n    -e /app/src/opengever.maintenance \\\n    -c requirements-core.txt \\\n    -c requirements-deployment.txt\n\nRUN find /app/opengever -name \"*.po\" | xargs -I@ sh -c 'msgfmt @ -o \"$(dirname @)/$(basename @ .po)\".mo' && \\\n    find /app/plonetheme -name \"*.po\" | xargs -I@ sh -c 'msgfmt @ -o \"$(dirname @)/$(basename @ .po)\".mo'\n\n# Plone needs permissions to update bundle schemas on import\nRUN chown -R plone:plone /app/opengever/bundle/schemas\n\nCOPY ./docker/core/etc /app/etc\nRUN chown -R plone:plone /app/etc\nCOPY ./docker/core/entrypoint.d /app/entrypoint.d\nCOPY ./docker/core/docker-entrypoint.sh ./docker/core/inituser /app/\nCOPY ./docker/core/zopectl /app/bin/\nCOPY --chown=plone ./docker/core/cron /app/cron\nRUN chmod 644 /app/cron/crontab\n\nRUN mkdir -p /app/var/log /app/var/instance \\\n && chown plone:plone /app/var/log \\\n && chown plone:plone /app/var/instance \\\n && ln -sf /dev/stderr /app/var/log/instance.log \\\n && ln -sf /dev/stdout /app/var/log/instance-json.log \\\n && ln -sf /dev/stdout /app/var/log/solr-maintenance.log \\\n && ln -sf /data/log/contentstats-json.log /app/var/log/contentstats-json.log \\\n && ln -sf /data/log/nightly-jobs.log /app/var/log/nightly-jobs.log \\\n && ln -sf /data/log/ogds-update.log /app/var/log/ogds-update.log\n\nRUN ln -sf /dev/null /app/var/log/upgrade_stats.csv\n\n# Patch cacert.pem with a recent version to address CVE-2023-37920\nRUN wget -O /app/lib/python2.7/site-packages/certifi/cacert.pem https://raw.githubusercontent.com/certifi/python-certifi/2024.02.02/certifi/cacert.pem\n\n# Patch ftw.bumblebee to use time.time() for timestamp generation\n# datetime.now().strftime('%s') does not return the same on Alpine Linux (musl)\n# https://www.openwall.com/lists/musl/2018/01/18/3\nCOPY ./docker/core/patches/hashing.py /app/lib/python2.7/site-packages/ftw/bumblebee/hashing.py\nRUN python2.7 -m compileall /app/lib/python2.7/site-packages/ftw/bumblebee/hashing.py\n\n# Patch p.a.theming to parse HTML with utf-8 encoding. By default the encoding is detected automatically.\n# This no longer works reliably since upgrading to Alpine 3.20, therefore we set the encoding manually\n# to utf-8 which should be fine for us.\nCOPY ./docker/core/patches/p_a_theming_transform.py /app/lib/python2.7/site-packages/plone/app/theming/transform.py\nRUN python2.7 -m compileall /app/lib/python2.7/site-packages/plone/app/theming/transform.py\n\n# go-crond builder\n# -----------------------------------------------------------------------------\nFROM golang:1.23-alpine3.20 AS go-crond-builder\n\nRUN apk upgrade --no-cache --force\nRUN apk add --update build-base make git\n\nRUN mkdir -p /go/src/github.com/webdevops \\\n && cd /go/src/github.com/webdevops \\\n && git clone https://github.com/webdevops/go-crond.git\n\nWORKDIR /go/src/github.com/webdevops/go-crond\n\nARG GOCROND_VERSION=23.12.0\n\nRUN git checkout $GOCROND_VERSION\nRUN go mod download\nRUN make test\nRUN make build\n\n# ogcore production image\n# -----------------------------------------------------------------------------\nFROM 4teamwork/plone:4.3.20-alpine3.20 AS prod\n\nUSER root\nRUN apk add \\\n    libldap \\\n    libffi \\\n    libpq \\\n    procps-ng\n\nCOPY --from=builder /app /app\nCOPY --from=go-crond-builder /go/src/github.com/webdevops/go-crond /usr/local/bin\n\nVOLUME /data\nWORKDIR /app\nENV PATH=\"/app/bin:$PATH\"\nUSER plone\nEXPOSE 8160\n"
        },
        "static_files": {}
    },
    "project_structure": {
        "files": [
            "Dockerfile",
            "docker-entrypoint.sh",
            "inituser",
            "requirements-core.txt",
            "requirements-deployment.txt",
            "zopectl"
        ],
        "folders": [
            "cron",
            "entrypoint.d",
            "etc",
            "packages",
            "patches",
            "scripts"
        ]
    }
}