{
    "docker_info": {
        "base_image": "\"${DAOS_DOCKER_IMAGE_NSP}/daos-base-${LINUX_DISTRO}:$DAOS_DOCKER_IMAGE_TAG\"",
        "multi_stage_build": false,
        "exposed_ports": [],
        "user": [],
        "labels": [
            "maintainer=\"daos@daos.groups.io\""
        ],
        "health_checks": [],
        "build_args": [
            "LINUX_DISTRO=\"\"",
            "DAOS_DOCKER_IMAGE_NSP=\"\"",
            "DAOS_DOCKER_IMAGE_TAG=\"\"",
            "DAOS_VERSION=\"\"",
            "DAOS_AUTH=\"\"",
            "DAOS_AGENT_IFACE_CFG=\"\"",
            "DAOS_AGENT_IFACE_NUMA_NODE=\"\"",
            "DAOS_AGENT_IFACE_NAME=\"\"",
            "DAOS_AGENT_IFACE_DOMAIN_NAME=\"\""
        ],
        "envs": [],
        "copy_instructions": [
            "COPY\tdaos_agent.yml.in /tmp/daos_agent.yml.in"
        ],
        "execution": [],
        "run": [
            [
                "for it in DAOS_VERSION ; do                                                                \\",
                "if eval \"[[ -z \\$$it ]]\" ; then",
                "echo \"[ERROR] Docker build argument $it is not defined\" ;",
                "exit 1 ;",
                "fi ;",
                "done &&",
                "dnf install",
                "daos-client-${DAOS_VERSION} &&",
                "dnf clean all &&",
                "systemctl enable daos_agent"
            ],
            [
                "for it in DAOS_AUTH DAOS_AGENT_IFACE_CFG DAOS_AGENT_IFACE_NUMA_NODE DAOS_AGENT_IFACE_NAME  \\",
                "DAOS_AGENT_IFACE_DOMAIN_NAME ; do",
                "if eval \"[[ -z \\$$it ]]\" ; then",
                "echo \"[ERROR] Docker build argument $it is not defined\" ;",
                "exit 1 ;",
                "fi ;",
                "done &&",
                "if [ \"$DAOS_AUTH\" == yes ] ; then",
                "sed --in-place --regexp-extended",
                "--expression '/^@DAOS_NOAUTH_BEGIN@$/,/^@DAOS_NOAUTH_END@/d'",
                "--expression '/(^@DAOS_AUTH_BEGIN@$)|(^@DAOS_AUTH_END@$)/d'",
                "/tmp/daos_agent.yml.in &&",
                "chmod 644 /root/daosCA/certs/daosCA.crt &&",
                "chmod 644 /root/daosCA/certs/agent.crt &&",
                "chmod 400 /root/daosCA/certs/agent.key &&",
                "chown root:root /root/daosCA/certs/daosCA.crt &&",
                "chown daos_agent:daos_agent /root/daosCA/certs/agent.crt &&",
                "chown daos_agent:daos_agent /root/daosCA/certs/agent.key &&",
                "mv /root/daosCA/certs/daosCA.crt /etc/daos/certs/. &&",
                "mv /root/daosCA/certs/agent.crt /etc/daos/certs/. &&",
                "mv /root/daosCA/certs/agent.key /etc/daos/certs/. &&",
                "rm -fr /root/daosCA ;",
                "else",
                "sed --in-place --regexp-extended",
                "--expression '/^@DAOS_AUTH_BEGIN@$/,/^@DAOS_AUTH_END@/d'",
                "--expression '/(^@DAOS_NOAUTH_BEGIN@$)|(^@DAOS_NOAUTH_END@$)/d'",
                "/tmp/daos_agent.yml.in ;",
                "fi &&",
                "if [[ \"${DAOS_AGENT_IFACE_CFG}\" == yes ]] ; then",
                "args=(",
                "DAOS_AGENT_IFACE_NUMA_NODE",
                "DAOS_AGENT_IFACE_NAME",
                "DAOS_AGENT_IFACE_DOMAIN_NAME",
                ") ;",
                "for it in $args; do",
                "if eval \"[[ -z \\\"\\$$it\\\" ]]\" ; then",
                "echo \"[ERROR] Docker build argument $it is not defined\" ;",
                "exit 1 ;",
                "fi ;",
                "done ;",
                "sed --in-place --regexp-extended",
                "--expression '/(^@DAOS_IFACE_BEGIN@$)|(^@DAOS_IFACE_END@$)/d'",
                "--expression \"s/@DAOS_IFACE_NUMA_NODE@/${DAOS_AGENT_IFACE_NUMA_NODE}/\"",
                "--expression \"s/@DAOS_IFACE_NAME@/${DAOS_AGENT_IFACE_NAME}/\"",
                "--expression \"s/@DAOS_IFACE_DOMAIN_NAME@/${DAOS_AGENT_IFACE_DOMAIN_NAME}/\"",
                "/tmp/daos_agent.yml.in ;",
                "else",
                "sed --in-place --regexp-extended",
                "--expression '/^@DAOS_IFACE_BEGIN@$/,/^@DAOS_IFACE_END@/d'",
                "/tmp/daos_agent.yml.in ;",
                "fi &&",
                "mv -f /tmp/daos_agent.yml.in /etc/daos/daos_agent.yml"
            ]
        ]
    }
}